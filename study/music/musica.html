<html>
<head>

<script src="musiclib.js"></script>
<script src="music4.js"></script>
<script>
try {
	var context = new AudioContext();
	var now = context.currentTime;
	now++;
	
	var den = 4;
	var tempo = 60 / 40;
	var measureLength1 = 3 / den * tempo;
	var measureLength2 = 4 / den * tempo;
	var pulses1  = [1, 3, 1, 1];
	var pulsesP1 = [3, 6, 3, 6];
	var pulses2  = [1, 1, 2, 1];
	var pulsesP2 = [2, 2, 2, 4, 2, 2, 4];
	var s1 = new SongA (context, measureLength1, pulses1, pulsesP1);
	var s2 = new Song2 (context, measureLength2, pulses2, pulsesP2);
	var I = Math.floor (Math.random () * Number.MAX_SAFE_INTEGER);
	
	function cycle () {
		s1.play (now + measureLength1 * 0, I);
		s2.play (now + measureLength2 * 0, I);
		
		s1.play (now + measureLength1 * 1, I);
		s2.play (now + measureLength2 * 1, I);
		
		s1.play (now + measureLength1 * 2, I);
		s2.play (now + measureLength2 * 2, I);
		
		s1.play (now + measureLength1 * 3, I);
		
		now += 12 / den * tempo;
	
		setTimeout(cycle, Math.max (0, (now - context.currentTime) * 1000 - 100));
	}
	cycle ();
} catch (e) { alert (e) }
</script>

</head>
</html>
