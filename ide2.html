<style type="text/css" media="screen">

</style>

<div>
	<input id="clone_url" type="url">
	<button>Clone</button>
	
	<button>Commit</button>
</div>
<script>
	var cloneUrl = document.getElementById ('clone_url');
	<!-- TODO use a reasonable URL -->
	cloneUrl.value = window.location.href;
</script>

<div id="editor" style="height: 500px; width: 500px">function foo(items) {
	var x = "All this is syntax highlighted";
	return x;
}</div>
    
<script src="ace-builds/src-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
<script>
    var editor = ace.edit("editor");
    editor.setTheme("ace/theme/terminal");
    editor.getSession().setMode("ace/mode/javascript");
    
    editor.setKeyboardHandler("ace/keyboard/vim");
</script>




<script src="http://requirejs.org/docs/release/2.3.5/comments/require.js"></script>

<script src="https://raw.github.com/ryanackley/git-html5.js/master/api-built.js"></script>
<script>
try {
	
// To obtain a reference to a directory named "projectHome" under the root filesystem directory you would use the following code.
window.requestFileSystem(window.PERSISTENT, 5*1024*1024*1024, function(fs){
    fs.root.getDirectory('projectHome', {create:true}, function(projectHome){
        // git-html5.js function calls go here.
        var options = {
			dir: projectHome,
			url: 'https://github.com/ryanackley/git-html5.js.git',
			depth: 1
		};

		GitApi.clone(options, function(){ 
			// clone has completed at this point, do something with the files that have been imported into dir
		});
    });
});

} catch (e) { alert (e) }
</script>








<script src="gitkit-js/bin/gitkit.js"></script>


<script>
try {
	
	var transport = new GitKit.HTTPTransport('https://github.com/InnovAnon-Inc/LHP.git');
} catch (e) { alert (e) }
</script>



<script>
try {

var repo = {};

// This only works for normal repos.  Github doesn't allow access to gists as
// far as I can tell.
var githubName = "InnovAnon-Inc/LHP";

// Your user can generate these manually at https://github.com/settings/tokens/new
// Or you can use an oauth flow to get a token for the user.
var githubToken = "";

// Mixin the main library using github to provide the following:
// - repo.loadAs(type, hash) => value
// - repo.saveAs(type, value) => hash
// - repo.readRef(ref) => hash
// - repo.updateRef(ref, hash) => hash
// - repo.createTree(entries) => hash
// - repo.hasHash(hash) => has
require('js-github/mixins/github-db')(repo, githubName, githubToken);


// Github has this built-in, but it's currently very buggy so we replace with
// the manual implementation in js-git.
require('js-git/mixins/create-tree')(repo);

// Cache everything except blobs over 100 bytes in memory.
// This makes path-to-hash lookup a sync operation in most cases.
require('js-git/mixins/mem-cache')(repo);

// Combine concurrent read requests for the same hash
require('js-git/mixins/read-combiner')(repo);

// Add in value formatting niceties.  Also adds text and array types.
require('js-git/mixins/formats')(repo);

// I'm using generator syntax, but callback style also works.
// See js-git main docs for more details.
var run = require('gen-run');
run(function* () {
  var headHash = yield repo.readRef("refs/heads/master");
  var commit = yield repo.loadAs("commit", headHash);
  var tree = yield repo.loadAs("tree", commit.tree);
  var entry = tree["README.md"];
  var readme = yield repo.loadAs("text", entry.hash);

  // Build the updates array
  var updates = [
    {
      path: "README.md", // Update the existing entry
      mode: entry.mode,  // Preserve the mode (it might have been executible)
      content: readme.toUpperCase() // Write the new content
    }
  ];
  // Based on the existing tree, we only want to update, not replace.
  updates.base = commit.tree;

  // Create the new file and the updated tree.
  var treeHash = yield repo.createTree(updates);

  var commitHash = yield repo.saveAs("commit", {
    tree: treeHash,
    author: {
      name: "Tim Caswell",
      email: "tim@creationix.com"
    },
    parent: headHash,
    message: "Change README.md to be all uppercase using js-github"
  });

  // Now we can browse to this commit by hash, but it's still not in master.
  // We need to update the ref to point to this new commit.
  console.log("COMMIT", commitHash)

  // Save it to a new branch (Or update existing one)
  var new_hash = yield repo.updateRef("refs/heads/new-branch", commitHash);

  // And delete this new branch:
  yield repo.deleteRef("refs/heads/new-branch");
});

} catch (e) { alert (e) }
</script>
